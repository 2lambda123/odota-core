extend layout

block head
    script(type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js')
    script(type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.2/moment.min.js')
    script(type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/c3/0.1.29/c3.js')
    script(type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/vis/3.5.0/vis.js')
    script(type='text/javascript' src='https://code.jquery.com/jquery-2.1.1.min.js')
    link(rel='stylesheet', href='//cdnjs.cloudflare.com/ajax/libs/c3/0.1.29/c3.css')
    link(rel='stylesheet', href='//cdnjs.cloudflare.com/ajax/libs/vis/3.5.0/vis.css')

    script.
     var match = !{JSON.stringify(match)}
    style.
     * {font-family: 'Roboto', sans-serif;}
     .items img {width: 35px;}
     
block content
        h1 Match #{match.match_id}
        .row
          .col-md-6
          .col-md-6
            table.table.table-condensed
              tr
                td Duration
                td Game Mode
              tr
                td= moment().startOf('day').seconds(match.duration).format("H:mm:ss")
                td= constants.modes[match.game_mode].name
        .row
          .col-md-12
            h1(class = match.radiant_win ? "success" : "danger").text-center= match.radiant_win ? "Radiant Victory" : "Dire Victory"
            table.table.table-hover.table-responsive.text-center
                  tr
                    th Player
                    th Hero
                    th Level
                    th K
                    th D
                    th A
                    th LH
                    th DN
                    th Gold
                    th GPM
                    th XPM
                    th HD
                    th TD
                    th HH
                    th Items
                  - each player, i in match.players
                   tr(class = i < 5 ? "success" : "danger")
                     td
                       if (player.account_id == constants.anonymous_account_id)
                         ="Anonymous"
                       else
                         a(href='/players/#{player.account_id}')=player.display_name ? player.display_name : player.account_id
                     - var hero = constants.heroes[player.hero_id]
                     td: img(src='http://cdn.dota2.com/apps/dota2/images/heroes/' + hero.name.replace('npc_dota_hero_', "") + "_sb.png", alt=hero.localized_name )
                     td= player.level
                     td= player.kills
                     td= player.deaths
                     td= player.assists
                     td= player.last_hits
                     td= player.denies
                     td= player.gold+player.gold_spent
                     td= player.gold_per_min
                     td= player.xp_per_min
                     td= player.hero_damage
                     td= player.tower_damage
                     td= player.hero_healing
                     td.items.text-left
                       each val, index in player
                         - if (index.slice(0, 5)==="item_")
                           - var item = constants.items[val]
                           if item
                             img(src='http://cdn.dota2.com/apps/dota2/images/items/' + item.img, alt=item.dname)
                         - if (index === "additional_units")
                           hr(style='margin:10px;')
                           each val, index in player.additional_units[0]
                             - var item = constants.items[val]
                             if item
                               img(src='http://cdn.dota2.com/apps/dota2/images/items/' + item.img, alt=item.dname)
        if match.parsed_data
          table.table
            tr
              th Player
              th Runes
              th Buybacks
              th Aegis
              th Courier Kills
              th TP/Used
              th Observer/Used
              th Sentry/Used
              th Smoke/Used
              th Dust/Used
              th Gem
            each player, i in match.parsed_data.players
              tr
                td=match.parsed_data.players[i].display_name
                td=match.parsed_data.players[i].runes.length
                td=match.parsed_data.players[i].buybacks.length
                td=match.parsed_data.players[i].aegis.length
                td=match.parsed_data.players[i].ckills.length
                td #{match.parsed_data.players[i].tp}/#{match.parsed_data.players[i].tp_used}
                td #{match.parsed_data.players[i].observer}/#{match.parsed_data.players[i].observer_used}
                td #{match.parsed_data.players[i].sentry}/#{match.parsed_data.players[i].sentry_used}
                td #{match.parsed_data.players[i].smoke}/#{match.parsed_data.players[i].smoke_used}
                td #{match.parsed_data.players[i].dust}/#{match.parsed_data.players[i].dust_used}
                td #{match.parsed_data.players[i].gem}
        .row
          #chart-diff
          #chart-gold
          #chart-xp
          #chart-lh
          #chart-timeline
          #chart-kills
          script(type='text/javascript', src='../public/js/chart.js')
          script(type='text/javascript', src='../public/js/graph.js')
          script(type='text/javascript', src='../public/js/timeline.js')

