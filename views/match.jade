extend layout

block head
    script(type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js')
    script(type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.2/moment.min.js')
    script(type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/c3/0.1.29/c3.js')
    script(type='text/javascript' src='https://code.jquery.com/jquery-2.1.1.min.js')
    script.
     var match = !{JSON.stringify(match)}
     var constants = !{JSON.stringify(constants)}
    style.
     * {font-family: 'Roboto', sans-serif;}
     .items img {width: 35px;}
     
block content
        h1 Match #{match.match_id}
        .row
          .col-md-6
          .col-md-6
            table.table.table-condensed
              tr
                td Duration
                td Game Mode
              tr
                td= moment().startOf('day').seconds(match.duration).format("H:mm:ss")
                td= constants.modes[match.game_mode].name
        .row
          .col-md-12
            h1(class = match.radiant_win ? "success" : "danger").text-center= match.radiant_win ? "Radiant Victory" : "Dire Victory"
            table.table.table-hover.table-responsive.text-center
                  tr
                    td Player
                    td Hero
                    td Level
                    td K
                    td D
                    td A
                    td LH
                    td DN
                    td Gold
                    td GPM
                    td XPM
                    td HD
                    td TD
                    td HH
                    td Items
                  - each player, i in match.players
                   tr(class = i < 5 ? "success" : "danger")
                     td
                       if (player.account_id == constants.anonymous_account_id)
                         ="Anonymous"
                       else
                         a(href='/players/#{player.account_id}')=player.display_name ? player.display_name : player.account_id
                     - var hero = constants.heroes[player.hero_id]
                     td: img(src='http://cdn.dota2.com/apps/dota2/images/heroes/' + hero.name.replace('npc_dota_hero_', "") + "_sb.png", alt=hero.localized_name )
                     td= player.level
                     td= player.kills
                     td= player.deaths
                     td= player.assists
                     td= player.last_hits
                     td= player.denies
                     td= player.gold+player.gold_spent
                     td= player.gold_per_min
                     td= player.xp_per_min
                     td= player.hero_damage
                     td= player.tower_damage
                     td= player.hero_healing
                     td.items.text-left
                       each val, index in player
                         - if (index.slice(0, 5)==="item_")
                           - var item = constants.items[val]
                           if item
                             img(src='http://cdn.dota2.com/apps/dota2/images/items/' + item.img, alt=item.dname)
                         - if (index === "additional_units")
                           hr(style='margin:10px;')
                           each val, index in player.additional_units[0]
                             - var item = constants.items[val]
                             if item
                               img(src='http://cdn.dota2.com/apps/dota2/images/items/' + item.img, alt=item.dname)
        if match.parsed_data
          each hero, name in match.parsed_data.combatlog
            h3=name
            h4 Purchases
            each purchase in hero.purchases
              p=JSON.stringify(purchase)
            h4 Uses
            each count, use in hero.uses
              p=use+":"+count
            h4 Kills
            each count, kill in hero.kills
              p=kill+":"+count
          each player in match.parsed_data.players
            p= JSON.stringify(player)
        .row
          #chart-diff
          #chart-gold
          #chart-xp
          #chart-lh
          script(type='text/javascript', src='../public/js/chart.js')
         